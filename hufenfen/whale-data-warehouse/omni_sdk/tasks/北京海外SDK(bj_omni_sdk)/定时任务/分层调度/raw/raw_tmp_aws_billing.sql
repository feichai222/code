INSERT OVERWRITE TABLE dw_omni_sdk.raw_tmp_aws_billing
SELECT replace(record [0], '\\', '') AS identity_LineItemId,
    replace(record [1], '\\', '') AS identity_TimeInterval,
    replace(record [2], '\\', '') AS bill_InvoiceId,
    replace(record [3], '\\', '') AS bill_InvoicingEntity,
    replace(record [4], '\\', '') AS bill_BillingEntity,
    replace(record [5], '\\', '') AS bill_BillType,
    replace(record [6], '\\', '') AS bill_PayerAccountId,
    replace(record [7], '\\', '') AS bill_BillingPeriodStartDate,
    replace(record [8], '\\', '') AS bill_BillingPeriodEndDate,
    replace(record [9], '\\', '') AS lineItem_UsageAccountId,
    replace(record [10], '\\', '') AS lineItem_LineItemType,
    replace(record [11], '\\', '') AS lineItem_UsageStartDate,
    replace(record [12], '\\', '') AS lineItem_UsageEndDate,
    replace(record [13], '\\', '') AS lineItem_ProductCode,
    replace(record [14], '\\', '') AS lineItem_UsageType,
    replace(record [15], '\\', '') AS lineItem_Operation,
    replace(record [16], '\\', '') AS lineItem_AvailabilityZone,
    replace(record [17], '\\', '') AS lineItem_ResourceId,
    replace(record [18], '\\', '') AS lineItem_UsageAmount,
    replace(record [19], '\\', '') AS lineItem_NormalizationFactor,
    replace(record [20], '\\', '') AS lineItem_NormalizedUsageAmount,
    replace(record [21], '\\', '') AS lineItem_CurrencyCode,
    replace(record [22], '\\', '') AS lineItem_UnblendedRate,
    replace(record [23], '\\', '') AS lineItem_UnblendedCost,
    replace(record [24], '\\', '') AS lineItem_BlendedRate,
    replace(record [25], '\\', '') AS lineItem_BlendedCost,
    replace(record [26], '\\', '') AS lineItem_LineItemDescription,
    replace(record [27], '\\', '') AS lineItem_TaxType,
    replace(record [28], '\\', '') AS lineItem_LegalEntity,
    replace(record [29], '\\', '') AS product_ProductName,
    replace(record [30], '\\', '') AS product_PurchaseOption,
    replace(record [31], '\\', '') AS product_alarmType,
    replace(record [32], '\\', '') AS product_availability,
    replace(record [33], '\\', '') AS product_availabilityZone,
    replace(record [34], '\\', '') AS product_brokerEngine,
    replace(record [35], '\\', '') AS product_cacheEngine,
    replace(record [36], '\\', '') AS product_capacitystatus,
    replace(record [37], '\\', '') AS product_classicnetworkingsupport,
    replace(record [38], '\\', '') AS product_clientLocation,
    replace(record [39], '\\', '') AS product_clockSpeed,
    replace(record [40], '\\', '') AS product_computeFamily,
    replace(record [41], '\\', '') AS product_countsAgainstQuota,
    replace(record [42], '\\', '') AS product_currentGeneration,
    replace(record [43], '\\', '') AS product_dataTransferQuota,
    replace(record [44], '\\', '') AS product_databaseEngine,
    replace(record [45], '\\', '') AS product_dedicatedEbsThroughput,
    replace(record [46], '\\', '') AS product_deploymentOption,
    replace(record [47], '\\', '') AS product_description,
    replace(record [48], '\\', '') AS product_dominantnondominant,
    replace(record [49], '\\', '') AS product_durability,
    replace(record [50], '\\', '') AS product_ecu,
    replace(record [51], '\\', '') AS product_endpointType,
    replace(record [52], '\\', '') AS product_engineCode,
    replace(record [53], '\\', '') AS product_enhancedNetworkingSupport,
    replace(record [54], '\\', '') AS product_enhancedNetworkingSupported,
    replace(record [55], '\\', '') AS product_feeDescription,
    replace(record [56], '\\', '') AS product_freeOverage,
    replace(record [57], '\\', '') AS product_fromLocation,
    replace(record [58], '\\', '') AS product_fromLocationType,
    replace(record [59], '\\', '') AS product_fromRegionCode,
    replace(record [60], '\\', '') AS product_group,
    replace(record [61], '\\', '') AS product_groupDescription,
    replace(record [62], '\\', '') AS product_instanceFamily,
    replace(record [63], '\\', '') AS product_instanceType,
    replace(record [64], '\\', '') AS product_instanceTypeFamily,
    replace(record [65], '\\', '') AS product_intelAvx2Available,
    replace(record [66], '\\', '') AS product_intelAvxAvailable,
    replace(record [67], '\\', '') AS product_intelTurboAvailable,
    replace(record [68], '\\', '') AS product_licenseModel,
    replace(record [69], '\\', '') AS product_location,
    replace(record [70], '\\', '') AS product_locationType,
    replace(record [71], '\\', '') AS product_logsDestination,
    replace(record [72], '\\', '') AS product_marketoption,
    replace(record [73], '\\', '') AS product_maxIopsBurstPerformance,
    replace(record [74], '\\', '') AS product_maxIopsvolume,
    replace(record [75], '\\', '') AS product_maxThroughputvolume,
    replace(record [76], '\\', '') AS product_maxVolumeSize,
    replace(record [77], '\\', '') AS product_memory,
    replace(record [78], '\\', '') AS product_memoryGib,
    replace(record [79], '\\', '') AS product_messageDeliveryFrequency,
    replace(record [80], '\\', '') AS product_messageDeliveryOrder,
    replace(record [81], '\\', '') AS product_minVolumeSize,
    replace(record [82], '\\', '') AS product_networkPerformance,
    replace(record [83], '\\', '') AS product_normalizationSizeFactor,
    replace(record [84], '\\', '') AS product_operatingSystem,
    replace(record [85], '\\', '') AS product_operation,
    replace(record [86], '\\', '') AS product_overageType,
    replace(record [87], '\\', '') AS product_physicalProcessor,
    replace(record [88], '\\', '') AS product_platoinstancename,
    replace(record [89], '\\', '') AS product_platostoragename,
    replace(record [90], '\\', '') AS product_platostoragetype,
    replace(record [91], '\\', '') AS product_platousagetype,
    replace(record [92], '\\', '') AS product_platovolumetype,
    replace(record [93], '\\', '') AS product_preInstalledSw,
    replace(record [94], '\\', '') AS product_pricingUnit,
    replace(record [95], '\\', '') AS product_processorArchitecture,
    replace(record [96], '\\', '') AS product_processorFeatures,
    replace(record [97], '\\', '') AS product_productFamily,
    replace(record [98], '\\', '') AS product_provisioned,
    replace(record [99], '\\', '') AS product_purchaseterm,
    replace(record [100], '\\', '') AS product_queueType,
    replace(record [101], '\\', '') AS product_region,
    replace(record [102], '\\', '') AS product_regionCode,
    replace(record [103], '\\', '') AS product_requestDescription,
    replace(record [104], '\\', '') AS product_requestType,
    replace(record [105], '\\', '') AS product_resourcePriceGroup,
    replace(record [106], '\\', '') AS product_routingTarget,
    replace(record [107], '\\', '') AS product_routingType,
    replace(record [108], '\\', '') AS product_servicecode,
    replace(record [109], '\\', '') AS product_servicename,
    replace(record [110], '\\', '') AS product_sku,
    replace(record [111], '\\', '') AS product_softwareType,
    replace(record [112], '\\', '') AS product_storage,
    replace(record [113], '\\', '') AS product_storageClass,
    replace(record [114], '\\', '') AS product_storageFamily,
    replace(record [115], '\\', '') AS product_storageMedia,
    replace(record [116], '\\', '') AS product_storageType,
    replace(record [117], '\\', '') AS product_tenancy,
    replace(record [118], '\\', '') AS product_toLocation,
    replace(record [119], '\\', '') AS product_toLocationType,
    replace(record [120], '\\', '') AS product_toRegionCode,
    replace(record [121], '\\', '') AS product_trafficDirection,
    replace(record [122], '\\', '') AS product_transferType,
    replace(record [123], '\\', '') AS product_usagetype,
    replace(record [124], '\\', '') AS product_vcpu,
    replace(record [125], '\\', '') AS product_version,
    replace(record [126], '\\', '') AS product_volumeApiName,
    replace(record [127], '\\', '') AS product_volumeType,
    replace(record [128], '\\', '') AS product_vpcnetworkingsupport,
    replace(record [129], '\\', '') AS pricing_LeaseContractLength,
    replace(record [130], '\\', '') AS pricing_OfferingClass,
    replace(record [131], '\\', '') AS pricing_PurchaseOption,
    replace(record [132], '\\', '') AS pricing_RateCode,
    replace(record [133], '\\', '') AS pricing_RateId,
    replace(record [134], '\\', '') AS pricing_currency,
    replace(record [135], '\\', '') AS pricing_publicOnDemandCost,
    replace(record [136], '\\', '') AS pricing_publicOnDemandRate,
    replace(record [137], '\\', '') AS pricing_term,
    replace(record [138], '\\', '') AS pricing_unit,
    replace(record [139], '\\', '') AS reservation_AmortizedUpfrontCostForUsage,
    replace(record [140], '\\', '') AS reservation_AmortizedUpfrontFeeForBillingPeriod,
    replace(record [141], '\\', '') AS reservation_EffectiveCost,
    replace(record [142], '\\', '') AS reservation_EndTime,
    replace(record [143], '\\', '') AS reservation_ModificationStatus,
    replace(record [144], '\\', '') AS reservation_NormalizedUnitsPerReservation,
    replace(record [145], '\\', '') AS reservation_NumberOfReservations,
    replace(record [146], '\\', '') AS reservation_RecurringFeeForUsage,
    replace(record [147], '\\', '') AS reservation_ReservationARN,
    replace(record [148], '\\', '') AS reservation_StartTime,
    replace(record [149], '\\', '') AS reservation_SubscriptionId,
    replace(record [150], '\\', '') AS reservation_TotalReservedNormalizedUnits,
    replace(record [151], '\\', '') AS reservation_TotalReservedUnits,
    replace(record [152], '\\', '') AS reservation_UnitsPerReservation,
    replace(record [153], '\\', '') AS reservation_UnusedAmortizedUpfrontFeeForBillingPeriod,
    replace(record [154], '\\', '') AS reservation_UnusedNormalizedUnitQuantity,
    replace(record [155], '\\', '') AS reservation_UnusedQuantity,
    replace(record [156], '\\', '') AS reservation_UnusedRecurringFee,
    replace(record [157], '\\', '') AS reservation_UpfrontValue,
    replace(record [158], '\\', '') AS savingsPlan_TotalCommitmentToDate,
    replace(record [159], '\\', '') AS savingsPlan_SavingsPlanARN,
    replace(record [160], '\\', '') AS savingsPlan_SavingsPlanRate,
    replace(record [161], '\\', '') AS savingsPlan_UsedCommitment,
    replace(record [162], '\\', '') AS savingsPlan_SavingsPlanEffectiveCost,
    replace(record [163], '\\', '') AS savingsPlan_AmortizedUpfrontCommitmentForBillingPeriod,
    replace(record [164], '\\', '') AS savingsPlan_RecurringCommitmentForBillingPeriod,
    replace(record [165], '\\', '') AS savingsPlan_StartTime,
    replace(record [166], '\\', '') AS savingsPlan_EndTime,
    replace(record [167], '\\', '') AS savingsPlan_OfferingType,
    replace(record [168], '\\', '') AS savingsPlan_PaymentOption,
    replace(record [169], '\\', '') AS savingsPlan_PurchaseTerm,
    replace(record [170], '\\', '') AS savingsPlan_Region,
    filename
FROM (
        SELECT split(origin,',(?=([^\\\"]*\\\"[^\\\"]*\\\")*[^\\\"]*$)') as record,
            filename
        FROM dw_omni_sdk.raw_tmp_aws_billing_filebeat_num
        WHERE filename = '20220228'
        AND origin not like '%identity/LineItemId%'
    ) AS rs_aws_billing;
